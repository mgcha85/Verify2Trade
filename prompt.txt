## 프로젝트 개요:
가상화폐에서 BTCUSDT를 기준으로, 내가 발견한 하나의 기법이 실제로 유효한지 벡테스트를 통해 검증하고, 유효한 경우 배포시 자동매매가 되도록 하는 프로젝트

## backend 요구사항
- Hive Partitioned Parquet + DuckDB로 구성된 데이터를 `BTCUSDT`와 시간 정보를 통해서 불러온다.
- 25, 50, 100 VWAP, 200, 400 선을 그린다.
- 5분봉, 15분봉, 시봉, 일봉을 그린다.
- 다양한 알고리즘을 구성할 수 있으니, 모두 적용될 수 있도록 서버화 해서 시간, symbol 정보를 주면, 위의 캔들 데이터를 불러와서 개발한 알고리즘으로 계산하여 buy, hold 정보를 제공하는 식으로 만든다. (실전용)
- backtest용으로 기간, symbol을 주면 데이터를 가져와서 backtest를 실행하여 종료한다. (SSE로 progress bar 지원)
- 모든 벡테스트는 저장이 되게 만들고 고유 id를 줘서 구분한다. 
- LLM 과 VLM을 모두 사용한다는 전제를 갖고 함수를 만든다; 이때 로컬 llm은 ollama를 사용한다. remote llm은 openai compatible somthing을 연결 예정 (API_KEY, BASE_URL, MODEL_NAME은 .env에서 받는다.)
- agents를 사용한다는 전제를 갖고, config.yaml에서 프롬프트와 다양한 세팅을 관리한다.
- rust는 가능한 최신버젼으로 해줄 것
- 개발의 모든 정보는 (개요, 소스트리, 기술스택 등등) README.md 를 만들어서 정리하고, API.md 에 API명세를 적고 curl로 예제를 보여줘. 모든 문서는 한국어로 작성해야 해.
- 배포는 podman compose 로 할 예정
- API_KEY 와 같은 주요 정보는 `.env` 사용
- 하드코딩을 피하기 위한 변수는 config.yaml에서 관리
- VLM_analysis은 내가 원하는 그림을 shot으로 주고 몇 가지 조건을 넣어서 얼마나 맞는지에 대해서 점수를 0~1까지 받는 로직

## frontend 요구사항
- 준비된 알고리즘을 조회해서 선택하고
- 기간과 symbol도 선택하여 backtest를 시작.
- backtest시 progress bar 표시
- 테스트가 완료되면 결과가 테이블로 나오고 (캔들도 이미지로 같이 보여질 수 있도록)
- 기간대비 seed money에서 어떤 결과가 있었는지 표시해준다 (승률 등 통계 자료).
- 나중에 backtest_id로 구분해서 조회 할 수 있도록 한다.
- 리더보드를 만들어서 랭킹으로 backtest를 구분 할 수 있도록 만든다.

## 매매전략
- 1시간봉이 이평 25선 아래로 내려간 뒤, 이평선을 닿고 다시 내려온 부분을 확인
- 전체 계좌의 1/4만큼 short position open, 만약 이후 2% 상승하면 같은 수량 추가 open -> 이후 평단 2% 이상 상승하면 손절, 익절의 경우, 1% 수익권이면 반익본절 걸어두고, 최대 3%까지 노림
- 위의 조건으로 벡테스트를 진행해서 테이블 형태의 데이터를 만드는데, 컬럼은 symbol, qty, open_time, close_time, is_succeed, profit(%), profit($), order, type, candle_1h, candle_1d, VLM_analysis
- 위의 컬럼에서 order는 1차 매수만 진행했는지, 2차 매수까지 진행 됐는지를 표시
- 위의 컬럼에서 type은 1차매수후 익절, 2차매수후 익절, 2차 매수후 손절, 1차매수후 반익반본, 2차매수후 반익반본 과 같은 경우를 구분하기 위해 만듬.
- candle_1h과 candle_1d의 경우 parquet데이터기 때문에 캔들 데이터를 ohlcv기준으로 (200x5) 이미지를 만들어서 넣는다. 
- VLM_analysis은 내가 원하는 그림을 shot으로 주고 몇 가지 조건을 넣어서 얼마나 맞는지에 대해서 점수를 0~1까지 받는 로직은 optional로 만들 것
- 벡테스트는 $10,000를 seed money로 한다.
- 이평선을 계산한 뒤, 컬럼을 추가하고 400선이 있어야 하므로, 벡테스트의 시작은 봉의 최초 400봉이후부터 진행한다.
- 결과는 bt_results 에 저장되고 화면에서 볼 수 있도록 한다.
- candle데이터의 이미지를 저장하기 위해선 backtest ID의 폴더를 만들어서 저장한다.

## 데이터 저장 구조
```
/cryptodata
  /symbol=BTCUSDT
    /year=2023
      /month=12/01.parquet
    /year=2024
      /month=01/01.parquet
  /symbol=ETHUSDT
    ...
```

## ollama list
```
NAME                                ID              SIZE      MODIFIED    
qwen3-vl:latest                     901cae732162    6.1 GB    7 days ago     
qllama/bge-reranker-v2-m3:latest    06e0e64a6f61    635 MB    7 days ago     
qwen3-embedding:4b                  df5bd2e3c74c    2.5 GB    7 days ago     
gpt-oss:20b                         17052f91a42e    13 GB     7 days ago     
qwen3-embedding:latest              64b933495768    4.7 GB    2 weeks ago   
```

## 기술 스택:
- Rust (polars)
- sqlite (WAL)
- duckDB (WAL)
- svelte
